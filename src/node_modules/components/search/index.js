import React, { useState, useLayoutEffect } from 'react'
import { Redirect } from 'react-router-dom';

const Search = ({ initialValue = "" }) => {
    const [value, setValue] = useState(initialValue)
    const [isSubmited, setIsSubmited] = useState(false)

    const handleChange = (e) => {
        e.preventDefault()
        setValue(e.target.value)
    }

    const handleSubmit = (e) => {
        e.preventDefault()
        setIsSubmited(true)
    }

    useLayoutEffect(() => {
        setIsSubmited(false)
    }, [isSubmited])

    if (isSubmited) {
        return <Redirect to={`/search/${value}`} />
    }

    return (
        < div className="input-group" >
            <form onSubmit={handleSubmit}>
                <input
                    type="text"
                    className="form-control"
                    value={value}
                    placeholder="Search..."
                    onChange={handleChange}
                />
            </form>
            <span className="input-group-btn">
                <button className="btn btn-default" onClick={handleSubmit}>
                    <span className="glyphicon glyphicon-search"></span>
                </button>
            </span>
        </div >
    )
}

export default Search